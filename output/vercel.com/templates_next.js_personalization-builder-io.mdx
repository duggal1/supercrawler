---
title: Builder.io Personalization Starter
description: No description
keywords: No keywords
canonicalUrl: https://vercel.com/templates/next.js/personalization-builder-io
---

## Table of Contents

{/* Auto-generated table of contents */}

[Skip to content](#geist-skip-)

* ProductsDX Platform[Previews Helping teams ship 6× faster](/products/previews)[AI Powering breakthroughs](/ai)Managed Infrastructure[Fluid compute Servers, in serverless form](/fluid)[Rendering Fast, scalable, and reliable](/products/rendering)[Observability Trace every step](/products/observability)[Security Scale without compromising](/security)Open Source[Next.js The native Next.js platform](/frameworks/nextjs)[Turborepo Speed with Enterprise scale](/solutions/turborepo)[AI SDK The AI Toolkit for Type](https://sdk.vercel.ai/)
* DX Platform[Previews Helping teams ship 6× faster](/products/previews)[AI Powering breakthroughs](/ai)
* [Previews Helping teams ship 6× faster](/products/previews)
* [AI Powering breakthroughs](/ai)
* Managed Infrastructure[Fluid compute Servers, in serverless form](/fluid)[Rendering Fast, scalable, and reliable](/products/rendering)[Observability Trace every step](/products/observability)[Security Scale without compromising](/security)
* [Fluid compute Servers, in serverless form](/fluid)
* [Rendering Fast, scalable, and reliable](/products/rendering)
* [Observability Trace every step](/products/observability)
* [Security Scale without compromising](/security)
* Open Source[Next.js The native Next.js platform](/frameworks/nextjs)[Turborepo Speed with Enterprise scale](/solutions/turborepo)[AI SDK The AI Toolkit for Type](https://sdk.vercel.ai/)
* [Next.js The native Next.js platform](/frameworks/nextjs)
* [Turborepo Speed with Enterprise scale](/solutions/turborepo)
* [AI SDK The AI Toolkit for Type](https://sdk.vercel.ai/)
* SolutionsUse Cases[AI Apps Deploy at the speed of AI](/solutions/ai-apps)[Composable Commerce Power storefronts that convert](/solutions/composable-commerce)[Marketing Sites Launch campaigns fast](/solutions/marketing-sites)[Multi-tenant Platforms Scale apps with one codebase](/solutions/multi-tenant-saas)[Web Apps Ship features, not infrastructure](/solutions/web-apps)Users[Platform Engineers Automate away repetition](/solutions/platform-engineering)[Design Engineers Deploy for every idea](/solutions/design-engineering)
* Use Cases[AI Apps Deploy at the speed of AI](/solutions/ai-apps)[Composable Commerce Power storefronts that convert](/solutions/composable-commerce)[Marketing Sites Launch campaigns fast](/solutions/marketing-sites)[Multi-tenant Platforms Scale apps with one codebase](/solutions/multi-tenant-saas)[Web Apps Ship features, not infrastructure](/solutions/web-apps)
* [AI Apps Deploy at the speed of AI](/solutions/ai-apps)
* [Composable Commerce Power storefronts that convert](/solutions/composable-commerce)
* [Marketing Sites Launch campaigns fast](/solutions/marketing-sites)
* [Multi-tenant Platforms Scale apps with one codebase](/solutions/multi-tenant-saas)
* [Web Apps Ship features, not infrastructure](/solutions/web-apps)
* Users[Platform Engineers Automate away repetition](/solutions/platform-engineering)[Design Engineers Deploy for every idea](/solutions/design-engineering)
* [Platform Engineers Automate away repetition](/solutions/platform-engineering)
* [Design Engineers Deploy for every idea](/solutions/design-engineering)
* ResourcesTools[Resource Center Today’s best practices](/resources)[Marketplace Extend and automate workflows](/marketplace)[Templates Jumpstart app development](/templates)[Guides Find help quickly](/guides)[Partner Finder Get help from solution partners](/partners/solution-partners)Company[Customers Trusted by the best teams](/customers)[Blog The latest posts and changes](/blog)[Changelog See what shipped](/changelog)[Press Read the latest news](/press)
* Tools[Resource Center Today’s best practices](/resources)[Marketplace Extend and automate workflows](/marketplace)[Templates Jumpstart app development](/templates)[Guides Find help quickly](/guides)[Partner Finder Get help from solution partners](/partners/solution-partners)
* [Resource Center Today’s best practices](/resources)
* [Marketplace Extend and automate workflows](/marketplace)
* [Templates Jumpstart app development](/templates)
* [Guides Find help quickly](/guides)
* [Partner Finder Get help from solution partners](/partners/solution-partners)
* Company[Customers Trusted by the best teams](/customers)[Blog The latest posts and changes](/blog)[Changelog See what shipped](/changelog)[Press Read the latest news](/press)
* [Customers Trusted by the best teams](/customers)
* [Blog The latest posts and changes](/blog)
* [Changelog See what shipped](/changelog)
* [Press Read the latest news](/press)
* [Enterprise](/enterprise)
* [Docs](/docs)
* [Pricing](/pricing)

[Log In](/login)

[Contact](/contact)

[Sign Up](/signup)

[← Back to Templates](/templates)

[BuilderIO/nextjs-edge-personalization-ab-testing](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing)

# Builder.io Personalization Starter

Learn how to use Builder.io to personalize your Next.js pages.

[Deploy](/new/clone?build-command=cd%20..%20%25%3B%20yarn%20build&demo-deion=Visually%20build%20a%20personalized%20Next.js%20site%20using%20Edge%20Middleware%20and%20Builder.io&demo-image=%2F%2Fimages.ctfassets.net%2Fe5382hct74si%2F7rUNlrXniYLMemSmdxQaZG%2F85067742bcf5a7d2057fd229316d3223%2FBuilder-Personalization-Template.gif&demo-title=Next.js%20Edge%20Personalization%20with%20Builder.io&demo-url=https%3A%2F%2Fnextjs-edge-personalization-demo.vercel.app%2F&project-name=nextjs-edge-personalization-builder-io&repository-name=nextjs-edge-personalization-builder-io&repository-url=https%3A%2F%2Fgithub.com%2FBuilderIO%2Fnextjs-edge-personalization-demo&root-directory=site)

[View Demo](https://nextjs-edge-personalization-demo.vercel.app/)

[Next.js](/templates/next.js)

[Starter](/templates/starter)

[CMS](/templates/cms)

[Tailwind](/templates/tailwind)

[Builder.io](/templates/builder.io)

![Builder.io Personalization Starter](/_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2Fe5382hct74si%2F7rUNlrXniYLMemSmdxQaZG%2F85067742bcf5a7d2057fd229316d3223%2FBuilder-Personalization-Template.gif&w=3840&q=75)

## Next.js + Builder.io Personalization & A/B Testing with Edge Middleware

[](https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2FBuilderIO%2Fnextjs-edge-personalization-demo&project-name=nextjs-edge-personalization-builder-io&repository-name=nextjs-edge-personalization-builder-io&demo-title=Next.js%20Edge%20Personalization%20with%20Builder.io&demo-deion=Visually%20build%20a%20personalized%20Next.js%20site%20using%20Edge%20Middleware%20and%20Builder.io&demo-url=https%3A%2F%2Fnextjs-edge-personalization-demo.vercel.app%2F&demo-image=https%3A%2F%2Fuser-images.githubusercontent.com%2F844291%2F187518010-ac87a42e-74de-46a0-b0c1-c8e2d97af547.gif&build-command=cd%20..%20%25;%20yarn%20build&root-directory=site)

This is a fork of[Next.js Commerce](https://github.com/vercel/commerce)with[Builder.io](https://www.builder.io)integrated and using[Edge Middleware](https://vercel.com/docs/concepts/functions/edge-middleware)to personalize pages with targeting and a/b testing with great performance.

[Try it here](https://builder.io/demo/commerce?demoHost=nextjs-edge-personalization-demo-git-editor-demo-builder-io.vercel.app&demoModel=page)

### Contents

* Overview
* How this works
* Get Started
* Explore the code
* Next Steps

### Overview

View an in depth overview of Builder.io + Vercel Edge Functions[here](https://www.youtube.com/watch?v=whn2o0LlJyA).

### How this works

In short, to personalize a page, we rewrite a basic path to a path + a hash of personalized attribtues.

For instance, if you have a`pages/page.tsx`, you can rename it to`pages/page/[hash].tsx`, and add it to be included into the rewriting[middleware](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing/tree/main/)to add the personalized hash at the end.

You can now have your page return personalized content based on what is in the hash, and this is purely automatic via what`personalization.*`cookies are present.

You can set them at any time to target off of, for instance:

```
Cookies
.
set
(
'personalization.returnVisitor'
,

'true'
)
```

And now your`/page`will be rewritten to`/page/returnVisitor=true`when that cookie is present, and be handled accordingly.

You can learn more about this technique[here](https://www.builder.io/blog/using-cookies-and-query-string-in-nextjs-static-pages).

Then, you can visually create and edit pages, sections, and data on your site with Builder.io's visual editor, dragging and dropping with your React components and publish unlimited variations to your site without any code or deploys needed:

### Get Started

#### Run Locally

```
git clone https
:
/
/
github
.
com
/
BuilderIO
/
nextjs
-
edge
-
personalization
-
demo
.
git
cd nextjs
-
edge
-
personalization
-
demo
```

Next, from the project root:

```
yarn # run
this
 command
in
 root folder
of
 the mono repo
yarn dev
```

To connect[Builder.io](https://www.builder.io), create a[free account](https://www.builder.io/signup), from your account settings copy your Public API Key and paste it into[site/config/builder.ts](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing/tree/main/).

Next, head to[builder.io/models](https://builder.io/models)and choose the`page`model and enter`http://localhost:3000`as the[preview URL](https://www.builder.io/c/docs/guides/preview-url), and then hit`save`at the top right of the page.

Now, in Builder.io add some[targeting attributes](https://www.builder.io/c/docs/custom-targeting-attributes)to begin personalizing your content on. Head to[builder.io/account](https://builder.io/account)and click on the pencil next to`Custom targeting attributes`and add some attributes; for instance as in this next image:

Above, we create an attribute called`returnVisitor`that is a boolean that we set[here](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing/tree/main/)so it can be read by edge middleware, as well as an attribute called`audience`that is an`enum`of a couple made up segments like`shirt-shipper`and`jacket-shopper`that we setherevia browsing history (could alternatively be set upon add to cart or other actions).

Note: generally`audiences`should come from a CDP, like

```
myCdp
.
getAudiences
(
)
.
then
(
(
audiences
)

=>

{

// assuming audiences is an array of strings, like ['shirt-shipper', 'jacket-shopper']

Cookies
.
set
(
'personalization.audience'
,

JSON
.
stringify
(
audiences
)
)
}
)
```

Now, go to[builder.io/content](https://builder.io/content)and choose the`+ new`button, choose`page`, and drag and drop to create a page on your Next.js site with your React components!

> :warning:**If you are having trouble connecting**: be sure you are running your dev server on`http://localhost:3000`by running`yarn dev`from this project root like shownabove
>

At the top of the editor, you can configure which audiences should see this page variant, and publish.

#### Deploy to Netlify

No work needed, just connect your repo to Netlify!

#### Deploy to Vercel

To get your site live, you can[deploy it to Vercel](https://nextjs.org/learn/basics/deploying-nextjs-app/deploy). Be sure to use the following configuration:

* **Framework preset**: Next.js
* **Build command**:`cd .. && yarn build`

Once you deploy to vercel, you can update your Preview URL to use the live URL so now others on your team can create content on your new site with Builder.io.

For example, if your site is now live at`https://my-site.vercel.app`, you can go back to[builder.io/models](https://builder.io/models), choose the`page`model, and update your Preview URL to`https://my-site.vercel.app`and save.

### Explore the code

Some key places to look in the codebase:

* [site/config/builder.ts](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing/tree/main/)is where we configure Builder.io custom components and settings.
* [site/middleware.ts](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing/tree/main/)is where we create and configure the edge middleware for personalizing pages.

### Next Steps

Learn more about:

* [Developing with Builder.io](https://www.builder.io/c/docs/developers)
* [Registering Custom Components with Builder.io](https://www.builder.io/c/docs/custom-components-intro)
* [Using Query Params and Cookies in Next.js Static Pages](https://www.builder.io/blog/using-cookies-and-query-string-in-nextjs-static-pages)
* [Next.js Middleware](https://nextjs.org/docs/advanced-features/middleware)
* [Next.js personalization utils](https://github.com/BuilderIO/builder/blob/main/packages/personalization-utils/README.md)used in this example

#### Troubleshooting

Run into any issues?[Chat with us in discord](https://discord.gg/TjSStcmuWN)!

[← Back to Templates](/templates)

![Builder.io Personalization Starter](/_next/image?url=https%3A%2F%2Fimages.ctfassets.net%2Fe5382hct74si%2F7rUNlrXniYLMemSmdxQaZG%2F85067742bcf5a7d2057fd229316d3223%2FBuilder-Personalization-Template.gif&w=3840&q=75)

[BuilderIO/nextjs-edge-personalization-ab-testing](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing)

# Builder.io Personalization Starter

Learn how to use Builder.io to personalize your Next.js pages.

[Deploy](/new/clone?build-command=cd%20..%20%25%3B%20yarn%20build&demo-deion=Visually%20build%20a%20personalized%20Next.js%20site%20using%20Edge%20Middleware%20and%20Builder.io&demo-image=%2F%2Fimages.ctfassets.net%2Fe5382hct74si%2F7rUNlrXniYLMemSmdxQaZG%2F85067742bcf5a7d2057fd229316d3223%2FBuilder-Personalization-Template.gif&demo-title=Next.js%20Edge%20Personalization%20with%20Builder.io&demo-url=https%3A%2F%2Fnextjs-edge-personalization-demo.vercel.app%2F&project-name=nextjs-edge-personalization-builder-io&repository-name=nextjs-edge-personalization-builder-io&repository-url=https%3A%2F%2Fgithub.com%2FBuilderIO%2Fnextjs-edge-personalization-demo&root-directory=site)

[View Demo](https://nextjs-edge-personalization-demo.vercel.app/)

[Next.js](/templates/next.js)

[Starter](/templates/starter)

[CMS](/templates/cms)

[Tailwind](/templates/tailwind)

[Builder.io](/templates/builder.io)

## Next.js + Builder.io Personalization & A/B Testing with Edge Middleware

[](https://vercel.com/new/clone?repository-url=https%3A%2F%2Fgithub.com%2FBuilderIO%2Fnextjs-edge-personalization-demo&project-name=nextjs-edge-personalization-builder-io&repository-name=nextjs-edge-personalization-builder-io&demo-title=Next.js%20Edge%20Personalization%20with%20Builder.io&demo-deion=Visually%20build%20a%20personalized%20Next.js%20site%20using%20Edge%20Middleware%20and%20Builder.io&demo-url=https%3A%2F%2Fnextjs-edge-personalization-demo.vercel.app%2F&demo-image=https%3A%2F%2Fuser-images.githubusercontent.com%2F844291%2F187518010-ac87a42e-74de-46a0-b0c1-c8e2d97af547.gif&build-command=cd%20..%20%25;%20yarn%20build&root-directory=site)

This is a fork of[Next.js Commerce](https://github.com/vercel/commerce)with[Builder.io](https://www.builder.io)integrated and using[Edge Middleware](https://vercel.com/docs/concepts/functions/edge-middleware)to personalize pages with targeting and a/b testing with great performance.

[Try it here](https://builder.io/demo/commerce?demoHost=nextjs-edge-personalization-demo-git-editor-demo-builder-io.vercel.app&demoModel=page)

### Contents

* Overview
* How this works
* Get Started
* Explore the code
* Next Steps

### Overview

View an in depth overview of Builder.io + Vercel Edge Functions[here](https://www.youtube.com/watch?v=whn2o0LlJyA).

### How this works

In short, to personalize a page, we rewrite a basic path to a path + a hash of personalized attribtues.

For instance, if you have a`pages/page.tsx`, you can rename it to`pages/page/[hash].tsx`, and add it to be included into the rewriting[middleware](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing/tree/main/)to add the personalized hash at the end.

You can now have your page return personalized content based on what is in the hash, and this is purely automatic via what`personalization.*`cookies are present.

You can set them at any time to target off of, for instance:

```
Cookies
.
set
(
'personalization.returnVisitor'
,

'true'
)
```

And now your`/page`will be rewritten to`/page/returnVisitor=true`when that cookie is present, and be handled accordingly.

You can learn more about this technique[here](https://www.builder.io/blog/using-cookies-and-query-string-in-nextjs-static-pages).

Then, you can visually create and edit pages, sections, and data on your site with Builder.io's visual editor, dragging and dropping with your React components and publish unlimited variations to your site without any code or deploys needed:

### Get Started

#### Run Locally

```
git clone https
:
/
/
github
.
com
/
BuilderIO
/
nextjs
-
edge
-
personalization
-
demo
.
git
cd nextjs
-
edge
-
personalization
-
demo
```

Next, from the project root:

```
yarn # run
this
 command
in
 root folder
of
 the mono repo
yarn dev
```

To connect[Builder.io](https://www.builder.io), create a[free account](https://www.builder.io/signup), from your account settings copy your Public API Key and paste it into[site/config/builder.ts](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing/tree/main/).

Next, head to[builder.io/models](https://builder.io/models)and choose the`page`model and enter`http://localhost:3000`as the[preview URL](https://www.builder.io/c/docs/guides/preview-url), and then hit`save`at the top right of the page.

Now, in Builder.io add some[targeting attributes](https://www.builder.io/c/docs/custom-targeting-attributes)to begin personalizing your content on. Head to[builder.io/account](https://builder.io/account)and click on the pencil next to`Custom targeting attributes`and add some attributes; for instance as in this next image:

Above, we create an attribute called`returnVisitor`that is a boolean that we set[here](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing/tree/main/)so it can be read by edge middleware, as well as an attribute called`audience`that is an`enum`of a couple made up segments like`shirt-shipper`and`jacket-shopper`that we setherevia browsing history (could alternatively be set upon add to cart or other actions).

Note: generally`audiences`should come from a CDP, like

```
myCdp
.
getAudiences
(
)
.
then
(
(
audiences
)

=>

{

// assuming audiences is an array of strings, like ['shirt-shipper', 'jacket-shopper']

Cookies
.
set
(
'personalization.audience'
,

JSON
.
stringify
(
audiences
)
)
}
)
```

Now, go to[builder.io/content](https://builder.io/content)and choose the`+ new`button, choose`page`, and drag and drop to create a page on your Next.js site with your React components!

> :warning:**If you are having trouble connecting**: be sure you are running your dev server on`http://localhost:3000`by running`yarn dev`from this project root like shownabove
>

At the top of the editor, you can configure which audiences should see this page variant, and publish.

#### Deploy to Netlify

No work needed, just connect your repo to Netlify!

#### Deploy to Vercel

To get your site live, you can[deploy it to Vercel](https://nextjs.org/learn/basics/deploying-nextjs-app/deploy). Be sure to use the following configuration:

* **Framework preset**: Next.js
* **Build command**:`cd .. && yarn build`

Once you deploy to vercel, you can update your Preview URL to use the live URL so now others on your team can create content on your new site with Builder.io.

For example, if your site is now live at`https://my-site.vercel.app`, you can go back to[builder.io/models](https://builder.io/models), choose the`page`model, and update your Preview URL to`https://my-site.vercel.app`and save.

### Explore the code

Some key places to look in the codebase:

* [site/config/builder.ts](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing/tree/main/)is where we configure Builder.io custom components and settings.
* [site/middleware.ts](https://github.com/BuilderIO/nextjs-edge-personalization-ab-testing/tree/main/)is where we create and configure the edge middleware for personalizing pages.

### Next Steps

Learn more about:

* [Developing with Builder.io](https://www.builder.io/c/docs/developers)
* [Registering Custom Components with Builder.io](https://www.builder.io/c/docs/custom-components-intro)
* [Using Query Params and Cookies in Next.js Static Pages](https://www.builder.io/blog/using-cookies-and-query-string-in-nextjs-static-pages)
* [Next.js Middleware](https://nextjs.org/docs/advanced-features/middleware)
* [Next.js personalization utils](https://github.com/BuilderIO/builder/blob/main/packages/personalization-utils/README.md)used in this example

#### Troubleshooting

Run into any issues?[Chat with us in discord](https://discord.gg/TjSStcmuWN)!

## Related Templates

[A/B Testing SimpleBy A/B testing at the edge, you'll reduce CLS from client-loaded experiments and improve your site's performance with smaller JS bundles.by▲ Vercel](/templates/next.js/ab-testing-simple)

## Unleash New Possibilities

Deploy your app on Vercel and unlock its full potential

## Products

* [AI](/ai)
* [Enterprise](/enterprise)
* [Fluid Compute](/fluid)
* [Next.js](/solutions/nextjs)
* [Observability](/products/observability)
* [Previews](/products/previews)
* [Rendering](/products/rendering)
* [Security](/security)
* [Turbo](/solutions/turborepo)
* [v0](https://v0.dev/)

## Resources

* [Community](https://community.vercel.com/)
* [Docs](/docs)
* [Guides](/guides)
* [Help](/help)
* [Integrations](/integrations)
* [Pricing](/pricing)
* [Resources](/resources)
* [Solution Partners](/partners/solution-partners)
* [Templates](/templates)

## Company

* [About](/about)
* [Blog](/blog)
* [Careers](/careers)
* [Changelog](/changelog)
* [Contact Us](/contact)
* [Customers](/customers)
* [Partners](/partners)
* [Privacy Policy](/legal/privacy-policy)
* Legal

## Social

* [GitHub](https://github.com/vercel)
* [LinkedIn](https://linkedin.com/company/vercel)
* [Twitter](https://x.com/vercel)
* [YouTube](https://youtube.com/@VercelHQ)

[Loading status…](https://vercel-status.com)